# VSCode-Extensions-Security-Analysis

Welcome to the ExtSecureScan repository! This repository contains the replication package for our research paper and additional support materials for reviewers.

## Code Overview 
The code directory contains several Python scripts:

- `unpack_vsix.py`: This script is used to unpack the VSCode extension packages (.vsix files) and extract the source code files (.js files) for further analysis.
- `main_for_code_analysis.py`: This script runs the code analysis and extracts code blocks for further analysis.
- `code/model_detect/bert/bert.sh`: This script is used to run the risk detection on the extracted data points using a fine-tuned BERT model. The model classifies each data point as credential-related or normal, and outputs the results in a CSV file for each extension.

## Data Files
This folder contains the data used and generated by our framework, including the metadata, the ground truth dataset, and the sources of the APIs.

- `data/extension_metas.json`: CThis file contains the metadata of all the extensions in our dataset, including the name, category, download link, etc.
- `data/Ground_Truth_datasets.csv`: This file contains the ground truth dataset that we manually labeled for model performance validation. It consists of 16,958 data points across 500 extensions, with binary labels indicating whether they are credential-related or not.
- `data/sources.json`: This file contains the sources of the APIs that we used to extract the vulnerable blocks from the PDGs. It includes the official VSCode API and some popular third-party libraries.
- `data/vul_detect_exts.json`: This file contains our detection results for 2325 extensions that possible expose credentials.

## Vendor Responses

- `Vendor_response.pdf`: This file contains the email responses from the extension vendors and the VSCode security team that we contacted to report our findings and recommendations.

## Video Proofs

The `Video_provement` folder contains the video evidence of the proof-of-concept attacks that we developed and published in the official VSCode marketplace but removed sudenly after it is approved byt the marketplace. These attacks demonstrate the feasibility and impact of exploiting the data exposure vulnerabilities in VSCode extensions.